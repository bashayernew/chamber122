<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Event Creation - Chamber122</title>
  <script>
    window.SUPABASE_URL = "https://gidbvemmqffogakcepka.supabase.co";
    window.SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpZGJ2ZW1tcWZmb2dha2NlcGthIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3NjI0MTUsImV4cCI6MjA3MjMzODQxNX0.rFFi4gq5ZUApmJM_FM5nfGpcPCHy9FLedVwmJOEzV1w";
  </script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: #fff; }
    .test-section { margin: 20px 0; padding: 20px; border: 1px solid #333; border-radius: 8px; }
    .test-button { background: #6f75ff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
    .test-button:hover { background: #5a5fcf; }
    .success { color: #4CAF50; }
    .error { color: #f44336; }
    .info { color: #2196F3; }
    .log { background: #2a2a2a; padding: 10px; border-radius: 4px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; }
    .form-group { margin: 10px 0; }
    .form-group label { display: block; margin-bottom: 5px; }
    .form-group input, .form-group select, .form-group textarea { 
      width: 100%; padding: 8px; border: 1px solid #555; border-radius: 4px; background: #333; color: #fff; 
    }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; }
    .modal-content { background: #1a1a1a; margin: 50px auto; padding: 20px; width: 80%; max-width: 600px; border-radius: 8px; }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .close { background: none; border: none; color: #fff; font-size: 24px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>🧪 Event Creation Test</h1>
  
  <div class="test-section">
    <h2>1. Script Loading Test</h2>
    <button class="test-button" onclick="testScriptLoading()">Test Script Loading</button>
    <div id="script-results" class="log"></div>
  </div>

  <div class="test-section">
    <h2>2. Event Form Test</h2>
    <button class="test-button" onclick="testEventForm()">Test Event Form</button>
    <div id="form-results" class="log"></div>
  </div>

  <div class="test-section">
    <h2>3. Event Creation Test</h2>
    <button class="test-button" onclick="openEventForm()">Open Event Form</button>
    <div id="creation-results" class="log"></div>
  </div>

  <!-- Event Form Modal -->
  <div id="event-form-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Create Event</h2>
        <button class="close" onclick="closeEventForm()">&times;</button>
      </div>
      
      <form id="event-creation-form">
        <div class="form-group">
          <label for="event-title">Event Title *</label>
          <input type="text" id="event-title" name="title" required>
        </div>
        
        <div class="form-group">
          <label for="event-type">Event Type *</label>
          <select id="event-type" name="type" required>
            <option value="">Select type...</option>
            <option value="networking">Networking</option>
            <option value="training">Training</option>
            <option value="workshop">Workshop</option>
            <option value="conference">Conference</option>
            <option value="exhibition">Exhibition</option>
            <option value="other">Other</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="event-description">Description</label>
          <textarea id="event-description" name="description" rows="3"></textarea>
        </div>
        
        <div class="form-group">
          <label for="event-location">Location</label>
          <input type="text" id="event-location" name="location">
        </div>
        
        <div class="form-group">
          <label for="event-start">Start Date *</label>
          <input type="date" id="event-start" name="start_date" required>
        </div>
        
        <div class="form-group">
          <label for="event-start-time">Start Time</label>
          <input type="time" id="event-start-time" name="start_time">
        </div>
        
        <div class="form-group">
          <label for="event-end">End Date</label>
          <input type="date" id="event-end" name="end_date">
        </div>
        
        <div class="form-group">
          <label for="event-end-time">End Time</label>
          <input type="time" id="event-end-time" name="end_time">
        </div>
        
        <div class="form-group">
          <label for="contact-name">Contact Name</label>
          <input type="text" id="contact-name" name="contact_name">
        </div>
        
        <div class="form-group">
          <label for="contact-email">Contact Email</label>
          <input type="email" id="contact-email" name="contact_email">
        </div>
        
        <div class="form-group">
          <label for="contact-phone">Contact Phone</label>
          <input type="tel" id="contact-phone" name="contact_phone">
        </div>
        
        <div class="form-group">
          <label for="event-link">Event Link</label>
          <input type="url" id="event-link" name="link">
        </div>
        
        <div class="form-group">
          <label for="event-cover-input">Cover Image</label>
          <input type="file" id="event-cover-input" name="cover_image" accept="image/*">
        </div>
        
        <div class="form-group">
          <label>
            <input type="checkbox" id="event-published" name="is_published"> Publish immediately
          </label>
        </div>
        
        <div id="event-status-message" style="display: none; padding: 10px; margin: 10px 0; border-radius: 4px;"></div>
        
        <div style="display: flex; gap: 10px; justify-content: flex-end;">
          <button type="button" id="cancel-event" onclick="closeEventForm()">Cancel</button>
          <button type="button" id="submit-event" onclick="handleEventSubmission()">Create Event</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Include the classic scripts in correct order -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/js/supabase-client.global.js?v=1"></script>
  <script src="/js/i18n.js?v=1"></script>
  <script src="/js/language-switcher.js?v=1"></script>
  <script src="/js/header-auth-slot.js?v=1"></script>
  <script src="/js/activities-list.js?v=1"></script>
  <script src="/js/event.js?v=1"></script>

  <script>
    function log(elementId, message, type = 'info') {
      const element = document.getElementById(elementId);
      const timestamp = new Date().toLocaleTimeString();
      element.textContent += `[${timestamp}] ${message}\n`;
      element.className = `log ${type}`;
    }
    
    function testScriptLoading() {
      log('script-results', 'Testing script loading...', 'info');
      
      const scripts = [
        { name: 'Supabase CDN', check: () => typeof window.supabase !== 'undefined' },
        { name: 'Supabase Client Global', check: () => typeof window.sb !== 'undefined' },
        { name: 'Event Functions', check: () => typeof window.openEventForm === 'function' },
        { name: 'Close Event Form', check: () => typeof window.closeEventForm === 'function' }
      ];
      
      let allLoaded = true;
      scripts.forEach(script => {
        if (script.check()) {
          log('script-results', `✅ ${script.name} loaded successfully`, 'success');
        } else {
          log('script-results', `❌ ${script.name} not loaded`, 'error');
          allLoaded = false;
        }
      });
      
      if (allLoaded) {
        log('script-results', '🎉 All scripts loaded successfully!', 'success');
      } else {
        log('script-results', '⚠️ Some scripts failed to load', 'error');
      }
    }
    
    function testEventForm() {
      log('form-results', 'Testing event form elements...', 'info');
      
      const formElements = [
        'event-title', 'event-type', 'event-description', 'event-location',
        'event-start', 'event-start-time', 'event-end', 'event-end-time',
        'contact-name', 'contact-email', 'contact-phone', 'event-link',
        'event-cover-input', 'event-published'
      ];
      
      let allFound = true;
      formElements.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          log('form-results', `✅ ${id} found`, 'success');
        } else {
          log('form-results', `❌ ${id} not found`, 'error');
          allFound = false;
        }
      });
      
      if (allFound) {
        log('form-results', '🎉 All form elements found!', 'success');
      } else {
        log('form-results', '⚠️ Some form elements missing', 'error');
      }
    }
    
    // Auto-run basic tests on page load
    document.addEventListener('DOMContentLoaded', () => {
      log('script-results', 'Event creation test page loaded', 'info');
      log('script-results', 'Click the test buttons to run individual tests', 'info');
      
      // Auto-run script loading test
      setTimeout(() => {
        testScriptLoading();
        testEventForm();
      }, 1000);
    });
  </script>
</body>
</html>
